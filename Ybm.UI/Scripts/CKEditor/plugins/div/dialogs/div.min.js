(function(){function n(n,t,i){t.is&&t.getCustomData("block_processed")||(t.is&&CKEDITOR.dom.element.setMarker(i,t,"block_processed",!0),n.push(t))}function t(t,i){function f(){this.foreach(function(n){/^(?!vbox|hbox)/.test(n.type)&&(n.setup||(n.setup=function(t){n.setValue(t.getAttribute(n.id)||"",1)}),!n.commit)&&(n.commit=function(t){var i=this.getValue();"dir"==n.id&&t.getComputedStyle("direction")==i||(i?t.setAttribute(n.id,i):t.removeAttribute(n.id))})})}var e=function(){var n=CKEDITOR.tools.extend({},CKEDITOR.dtd.$blockLimit);return t.config.div_wrapTable&&(delete n.td,delete n.th),n}(),o=CKEDITOR.dtd.div,u={},r=[];return{title:t.lang.div.title,minWidth:400,minHeight:165,contents:[{id:"info",label:t.lang.common.generalTab,title:t.lang.common.generalTab,elements:[{type:"hbox",widths:["50%","50%"],children:[{id:"elementStyle",type:"select",style:"width: 100%;",label:t.lang.div.styleSelectLabel,"default":"",items:[[t.lang.common.notSet,""]],onChange:function(){var i=["info:elementStyle","info:class","advanced:dir","advanced:style"],n=this.getDialog(),f=n._element&&n._element.clone()||new CKEDITOR.dom.element("div",t.document);this.commit(f,!0);for(var i=[].concat(i),e=i.length,r,u=0;u<e;u++)(r=n.getContentElement.apply(n,i[u].split(":")))&&r.setup&&r.setup(f,!0)},setup:function(n){for(var t in u)u[t].checkElementRemovable(n,!0)&&this.setValue(t,1)},commit:function(n){var t;(t=this.getValue())?u[t].applyToObject(n):n.removeAttribute("style")}},{id:"class",type:"text",requiredContent:"div(cke-xyz)",label:t.lang.common.cssClass,"default":""}]}]},{id:"advanced",label:t.lang.common.advancedTab,title:t.lang.common.advancedTab,elements:[{type:"vbox",padding:1,children:[{type:"hbox",widths:["50%","50%"],children:[{type:"text",id:"id",requiredContent:"div[id]",label:t.lang.common.id,"default":""},{type:"text",id:"lang",requiredContent:"div[lang]",label:t.lang.common.langCode,"default":""}]},{type:"hbox",children:[{type:"text",id:"style",requiredContent:"div{cke-xyz}",style:"width: 100%;",label:t.lang.common.cssStyle,"default":"",commit:function(n){n.setAttribute("style",this.getValue())}}]},{type:"hbox",children:[{type:"text",id:"title",requiredContent:"div[title]",style:"width: 100%;",label:t.lang.common.advisoryTitle,"default":""}]},{type:"select",id:"dir",requiredContent:"div[dir]",style:"width: 100%;",label:t.lang.common.langDir,"default":"",items:[[t.lang.common.notSet,""],[t.lang.common.langDirLtr,"ltr"],[t.lang.common.langDirRtl,"rtl"]]}]}]}],onLoad:function(){f.call(this);var i=this,n=this.getContentElement("info","elementStyle");t.getStylesSet(function(r){var e,f,o;if(r)for(o=0;o<r.length;o++)f=r[o],f.element&&"div"==f.element&&(e=f.name,u[e]=f=new CKEDITOR.style(f),t.filter.check(f)&&(n.items.push([e,e]),n.add(e,e)));n[1<n.items.length?"enable":"disable"]();setTimeout(function(){i._element&&n.setup(i._element)},0)})},onShow:function(){"editdiv"==i&&this.setupContent(this._element=CKEDITOR.plugins.div.getSurroundDiv(t))},onOk:function(){var f;if("editdiv"==i)r=[this._element];else{for(var v=[],c={},a=[],u,y=t.getSelection(),h=y.getRanges(),p=y.createBookmarks(),l,s=0;s<h.length;s++)for(l=h[s].createIterator();u=l.getNextParagraph();)if(u.getName()in e&&!u.isReadOnly())for(f=u.getChildren(),u=0;u<f.count();u++)n(a,f.getItem(u),c);else{for(;!o[u.getName()]&&!u.equals(h[s].root);)u=u.getParent();n(a,u,c)}for(CKEDITOR.dom.element.clearAllMarkers(c),h=[],s=null,l=0;l<a.length;l++)u=a[l],f=t.elementPath(u).blockLimit,f.isReadOnly()&&(f=f.getParent()),t.config.div_wrapTable&&f.is(["td","th"])&&(f=t.elementPath(f.getParent()).blockLimit),f.equals(s)||(s=f,h.push([])),h[h.length-1].push(u);for(s=0;s<h.length;s++){for(f=h[s][0],a=f.getParent(),u=1;u<h[s].length;u++)a=a.getCommonAncestor(h[s][u]);for(l=new CKEDITOR.dom.element("div",t.document),u=0;u<h[s].length;u++){for(f=h[s][u];!f.getParent().equals(a);)f=f.getParent();h[s][u]=f}for(u=0;u<h[s].length;u++)(f=h[s][u],f.getCustomData&&f.getCustomData("block_processed"))||(f.is&&CKEDITOR.dom.element.setMarker(c,f,"block_processed",!0),u||l.insertBefore(f),l.append(f));CKEDITOR.dom.element.clearAllMarkers(c);v.push(l)}y.selectBookmarks(p);r=v}for(v=r.length,c=0;c<v;c++)this.commitContent(r[c]),r[c].getAttribute("style")||r[c].removeAttribute("style");this.hide()},onHide:function(){"editdiv"==i&&this._element.removeCustomData("elementStyle");delete this._element}}}CKEDITOR.dialog.add("creatediv",function(n){return t(n,"creatediv")});CKEDITOR.dialog.add("editdiv",function(n){return t(n,"editdiv")})})();
//# sourceMappingURL=div.min.js.map
