(function(){function f(n){for(var t,r,n=n.toUpperCase(),f=h.length,u=0,i=0;i<f;++i)for(t=h[i],r=t[1].length;n.substr(0,r)==t[1];n=n.substr(r))u+=t[0];return u}function e(n){for(var n=n.toUpperCase(),r=c.length,t=1,i=1;0<n.length;i*=r)t+=c.indexOf(n.charAt(n.length-1))*i,n=n.substr(0,n.length-1);return t}var o=CKEDITOR.htmlParser.fragment.prototype,t=CKEDITOR.htmlParser.element.prototype;o.onlyChild=t.onlyChild=function(){var n=this.children;return 1==n.length&&n[0]||null};t.removeAnyChildWithName=function(n){for(var u=this.children,i=[],t,r=0;r<u.length;r++)t=u[r],t.name&&(t.name==n&&(i.push(t),u.splice(r--,1)),i=i.concat(t.removeAnyChildWithName(n)));return i};t.getAncestor=function(n){for(var t=this.parent;t&&(!t.name||!t.name.match(n));)t=t.parent;return t};o.firstChild=t.firstChild=function(n){for(var t,i=0;i<this.children.length;i++)if(t=this.children[i],n(t)||t.name&&(t=t.firstChild(n)))return t;return null};t.addStyle=function(n,t,i){var r="",u;if("string"==typeof t)r+=n+":"+t+";";else{if("object"==typeof n)for(u in n)n.hasOwnProperty(u)&&(r+=u+":"+n[u]+";");else r+=n;i=t}this.attributes||(this.attributes={});n=this.attributes.style||"";n=(i?[r,n]:[n,r]).join(";");this.attributes.style=n.replace(/^;|;(?=;)/,"")};t.getStyle=function(n){var t=this.attributes.style;if(t)return t=CKEDITOR.tools.parseCssText(t,1),t[n]};CKEDITOR.dtd.parentOf=function(n){var i={};for(var t in this)-1==t.indexOf("$")&&this[t][n]&&(i[t]=1);return i};var v=/^([.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i,s=/^(?:\b0[^\s]*\s*){1,4}$/,u={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},h=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],c="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=0,n=null,r,l=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(n,t){var i=new CKEDITOR.htmlParser.element("cke:listbullet");return i.attributes={"cke:listsymbol":n[0]},i.add(new CKEDITOR.htmlParser.text(t)),i},isListBulletIndicator:function(n){if(/mso-list\s*:\s*Ignore/i.test(n.attributes&&n.attributes.style))return!0},isContainingOnlySpaces:function(n){var t;return(t=n.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(t.value)},resolveList:function(t){var u=t.attributes,f;return(f=t.removeAnyChildWithName("cke:listbullet"))&&f.length&&(f=f[0])?(t.name="cke:li",u.style&&(u.style=l.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(t){t=t.split(" ");t=CKEDITOR.tools.convertToPx(t[3]||t[1]||t[0]);!i&&null!==n&&t>n&&(i=t-n);n=t;u["cke:indent"]=i&&Math.ceil(t/i)+1||1}],[/^mso-list$/,null,function(n){var n=n.split(" "),t=Number(n[0].match(/\d+/)),n=Number(n[1].match(/\d+/));1==n&&(t!==r&&(u["cke:reset"]=1),r=t);u["cke:indent"]=n}]])(u.style,t)||""),u["cke:indent"]||(n=0,u["cke:indent"]=1),CKEDITOR.tools.extend(u,f.attributes),!0):(r=n=i=null,!1)},getStyleComponents:function(){var n=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"><\/div>',CKEDITOR.document);return CKEDITOR.document.getBody().append(n),function(t,i,r){n.setStyle(t,i);for(var t={},i=r.length,u=0;u<i;u++)t[r[u]]=n.getStyle(r[u]);return t}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(t,i){var i="number"==typeof i?i:1,h=t.attributes,c,f,u,e;switch(h.type){case"a":c="lower-alpha";break;case"1":c="decimal"}for(f=t.children,e=0;e<f.length;e++)if(u=f[e],u.name in CKEDITOR.dtd.$listItem){var o=u.attributes,s=u.children,a=s[s.length-1];a.name in CKEDITOR.dtd.$list&&(t.add(a,e+1),--s.length||f.splice(e--,1));u.name="cke:li";h.start&&!e&&(o.value=h.start);l.filters.stylesFilter([["tab-stops",null,function(t){(t=t.split(" ")[1].match(v))&&(n=CKEDITOR.tools.convertToPx(t[0]))}],1==i?["mso-list",null,function(n){n=n.split(" ");n=Number(n[0].match(/\d+/));n!==r&&(o["cke:reset"]=1);r=n}]:null])(o.style);o["cke:indent"]=i;o["cke:listtype"]=t.name;o["cke:list-style-type"]=c}else if(u.name in CKEDITOR.dtd.$list){for(arguments.callee.apply(this,[u,i+1]),f=f.slice(0,e).concat(u.children).concat(f.slice(e+1)),t.children=[],u=0,s=f.length;u<s;u++)t.add(f[u]);f=t.children}delete t.name;h["cke:list"]=1},assembleList:function(t){for(var w,b,k,d=t.children,a,nt,tt,v,h,s,t=[],o,it,c,l,y,g,p=0;p<d.length;p++)if(a=d[p],"cke:li"==a.name)if(a.name="li",nt=a.attributes,c=(c=nt["cke:listsymbol"])&&c.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),l=y=g=null,nt["cke:ignored"])d.splice(p--,1);else{if(nt["cke:reset"]&&(s=v=h=null),tt=Number(nt["cke:indent"]),tt!=v&&(it=o=null),c){if(it&&u[it][o].test(c[1]))l=it,y=o;else for(w in u)for(b in u[w])if(u[w][b].test(c[1]))if("ol"==w&&/alpha|roman/.test(b))(o=/roman/.test(b)?f(c[1]):e(c[1]),!g||o<g)&&(g=o,l=w,y=b);else{l=w;y=b;break}l||(l=c[2]?"ol":"ul")}else l=nt["cke:listtype"]||"ol",y=nt["cke:list-style-type"];if(it=l,o=y||("ol"==l?"decimal":"disc"),y&&y!=("ol"==l?"decimal":"disc")&&a.addStyle("list-style-type",y),"ol"==l&&c){switch(y){case"decimal":g=Number(c[1]);break;case"lower-roman":case"upper-roman":g=f(c[1]);break;case"lower-alpha":case"upper-alpha":g=e(c[1])}a.attributes.value=g}if(s){if(tt>v)t.push(s=new CKEDITOR.htmlParser.element(l)),s.add(a),h.add(s);else{if(tt<v)for(v-=tt;v--&&(k=s.parent);)s=k.parent;s.add(a)}d.splice(p--,1)}else t.push(s=new CKEDITOR.htmlParser.element(l)),s.add(a),d[p]=s;h=a;v=tt}else s&&(s=v=h=null);for(p=0;p<t.length;p++)if(s=t[p],w=s.children,o=o=void 0,b=s.children.length,k=o=void 0,d=/list-style-type:(.*?)(?:;|$)/,v=CKEDITOR.plugins.pastefromword.filters.stylesFilter,o=s.attributes,!d.exec(o.style)){for(h=0;h<b;h++)if(o=w[h],o.attributes.value&&Number(o.attributes.value)==h+1&&delete o.attributes.value,o=d.exec(o.attributes.style))if(o[1]!=k&&k){k=null;break}else k=o[1];if(k){for(h=0;h<b;h++)o=w[h].attributes,o.style&&(o.style=v([["list-style-type"]])(o.style)||"");s.addStyle("list-style-type",k)}}r=n=i=null},falsyFilter:function(){return!1},stylesFilter:function(n,t){return function(i,r){var u=[],f;for((i||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(i,f,e){f=f.toLowerCase();"font-family"==f&&(e=e.replace(/["']/g,""));for(var h,o,c,s=0;s<n.length;s++)if(n[s]&&(i=n[s][0],h=n[s][1],o=n[s][2],c=n[s][3],f.match(i)&&(!h||e.match(h)))){f=c||f;t&&(o=o||e);"function"==typeof o&&(o=o(e,r,f));o&&o.push&&(f=o[0],o=o[1]);"string"==typeof o&&u.push([f,o]);return}t||u.push([f,e])}),f=0;f<u.length;f++)u[f]=u[f].join(":");return u.length?u.join(";")+";":!1}},elementMigrateFilter:function(n,t){return n?function(i){var r=t?new CKEDITOR.style(n,t)._.definition:n;i.name=r.element;CKEDITOR.tools.extend(i.attributes,CKEDITOR.tools.clone(r.attributes));i.addStyle(CKEDITOR.style.getStyleText(r))}:function(){}},styleMigrateFilter:function(n,t){var i=this.elementMigrateFilter;return n?function(r,u){var f=new CKEDITOR.htmlParser.element(null),e={};e[t]=r;i(n,e)(f);f.children=u.children;u.children=[f];f.filter=function(){};f.parent=u}:function(){}},bogusAttrFilter:function(n,t){if(-1==t.name.indexOf("cke:"))return!1},applyStyleFilter:null},getRules:function(n,t){var f=CKEDITOR.dtd,k=CKEDITOR.tools.extend({},f.$block,f.$listItem,f.$tableContent),i=n.config,u=this.filters,o=u.falsyFilter,c=u.stylesFilter,r=u.elementMigrateFilter,h=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),p=this.utils.createListBulletMarker,l=u.flattenList,w=u.assembleList,a=this.utils.isListBulletIndicator,v=this.utils.isContainingOnlySpaces,b=this.utils.resolveList,d=function(n){return n=CKEDITOR.tools.convertToPx(n),isNaN(n)?n:n+"px"},g=this.utils.getStyleComponents,nt=this.utils.listDtdParents,e=!1!==i.pasteFromWordRemoveFontStyles,y=!1!==i.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(n){n.filterChildren(t);w(n)},elements:{"^":function(n){var t;CKEDITOR.env.gecko&&(t=u.applyStyleFilter)&&t(n)},$:function(n){var u=n.name||"",e=n.attributes;if(u in k&&e.style&&(e.style=c([[/^(:?width|height)$/,null,d]])(e.style)||""),u.match(/h\d/)){if(n.filterChildren(t),b(n))return;r(i["format_"+u])(n)}else if(u in f.$inline)n.filterChildren(t),v(n)&&delete n.name;else if(-1!=u.indexOf(":")&&-1==u.indexOf("cke")){if(n.filterChildren(t),"v:imagedata"==u){(u=n.attributes["o:href"])&&(n.attributes.src=u);n.name="img";return}delete n.name}u in nt&&(n.filterChildren(t),w(n))},style:function(n){if(CKEDITOR.env.gecko){var n=(n=n.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&n[1],t={};n&&(n.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(n,i,r){for(var i=i.split(","),n=i.length,u=0;u<n;u++)CKEDITOR.tools.trim(i[u]).replace(/^(\w+)(\.[\w-]+)?$/g,function(n,i,u){i=i||"*";u=u.substring(1,u.length);u.match(/MsoNormal/)||(t[i]||(t[i]={}),u?t[i][u]=r:t[i]=r)})}),u.applyStyleFilter=function(n){var i=t["*"]?"*":n.name,r=n.attributes&&n.attributes["class"];i in t&&(i=t[i],"object"==typeof i&&(i=i[r]),i&&n.addStyle(i,!0))})}return!1},p:function(n){if(/MsoListParagraph/i.exec(n.attributes["class"])||n.getStyle("mso-list")){var u=n.firstChild(function(n){return n.type==CKEDITOR.NODE_TEXT&&!v(n.parent)});(u=u&&u.parent)&&u.addStyle("mso-list","Ignore")}n.filterChildren(t);b(n)||(i.enterMode==CKEDITOR.ENTER_BR?(delete n.name,n.add(new CKEDITOR.htmlParser.element("br"))):r(i["format_"+(i.enterMode==CKEDITOR.ENTER_P?"p":"div")])(n))},div:function(n){var t=n.onlyChild(),i;t&&"table"==t.name&&(i=n.attributes,t.attributes=CKEDITOR.tools.extend(t.attributes,i),i.style&&t.addStyle(i.style),t=new CKEDITOR.htmlParser.element("div"),t.addStyle("clear","both"),n.add(t),delete n.name)},td:function(n){n.getAncestor("thead")&&(n.name="th")},ol:l,ul:l,dl:l,font:function(n){if(a(n.parent))delete n.name;else{n.filterChildren(t);var i=n.attributes,r=i.style,u=n.parent;"font"==u.name?(CKEDITOR.tools.extend(u.attributes,n.attributes),r&&u.addStyle(r),delete n.name):(r=r||"",i.color&&("#000000"!=i.color&&(r+="color:"+i.color+";"),delete i.color),i.face&&(r+="font-family:"+i.face+";",delete i.face),i.size&&(r+="font-size:"+(3<i.size?"large":3>i.size?"small":"medium")+";",delete i.size),n.name="span",n.addStyle(r))}},span:function(n){if(a(n.parent))return!1;if(n.filterChildren(t),v(n))return delete n.name,null;if(a(n)){var r=n.firstChild(function(n){return n.value||"img"==n.name}),u=(r=r&&(r.value||"l."))&&r.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(u)return r=p(u,r),(n=n.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(n.attributes.style)&&(r.attributes["cke:ignored"]=1),r}return(u=(r=n.attributes)&&r.style)&&(r.style=c([["line-height"],[/^font-family$/,null,e?null:h(i.font_style,"family")],[/^font-size$/,null,e?null:h(i.fontSize_style,"size")],[/^color$/,null,e?null:h(i.colorButton_foreStyle,"color")],[/^background-color$/,null,e?null:h(i.colorButton_backStyle,"color")]])(u,n)||""),r.style||delete r.style,CKEDITOR.tools.isEmpty(r)&&delete n.name,null},b:r(i.coreStyles_bold),i:r(i.coreStyles_italic),u:r(i.coreStyles_underline),s:r(i.coreStyles_strike),sup:r(i.coreStyles_superscript),sub:r(i.coreStyles_subscript),a:function(n){n=n.attributes;n.href&&n.href.match(/^file:\/\/\/[\S]+#/i)&&(n.href=n.href.replace(/^file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(n){n.getAncestor(/h\d/)&&!i.pasteFromWordNumberedHeadingToList&&delete n.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:c(y?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(n,t,r){if(t.name in{p:1,div:1}){if(t="ltr"==i.contentsLangDirection?"margin-left":"margin-right","margin"==r)n=g(r,n,[t])[t];else if(r!=t)return null;if(n&&!s.test(n))return[t,n]}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(n,t){if("img"==t.name)return n}],[/^width|height$/,null,function(n,t){if(t.name in{table:1,td:1,th:1,img:1})return n}]]:[[/^mso-/],[/-color$/,null,function(n){return"transparent"==n?!1:CKEDITOR.env.gecko?n.replace(/-moz-use-text-color/g,"transparent"):void 0}],[/^margin$/,s],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],e?[/font-?/]:null],y),width:function(n,t){if(t.name in f.$tableContent)return!1},border:function(n,t){if(t.name in f.$tableContent)return!1},"class":o,bgcolor:o,valign:y?o:function(n,t){return t.addStyle("vertical-align",n),!1}},comment:CKEDITOR.env.ie?o:function(n,t){var r=n.match(/<img.*?>/),i=n.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return i?(i=(r=i[1]||r&&"l.")&&r.match(/>(?:[(]?)([^\s]+?)([.)]?)</),p(i,r)):CKEDITOR.env.gecko&&r?(r=CKEDITOR.htmlParser.fragment.fromHtml(r[0]).children[0],(i=(i=(i=t.previous)&&i.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&i[1])&&(r.attributes.src=i),r):!1}}}},a=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};a.prototype={toHtml:function(n){var n=CKEDITOR.htmlParser.fragment.fromHtml(n),t=new CKEDITOR.htmlParser.basicWriter;return n.writeHtml(t,this.dataFilter),t.getHtml(!0)}};CKEDITOR.cleanWord=function(n,t){CKEDITOR.env.gecko&&(n=n.replace(/(<\!--\[if[^<]*?\])--\>([\S\s]*?)<\!--(\[endif\]--\>)/gi,"$1$2$3"));CKEDITOR.env.webkit&&(n=n.replace(/(class="MsoListParagraph[^>]+><\!--\[if !supportLists\]--\>)([^<]+<span[^<]+<\/span>)(<\!--\[endif\]--\>)/gi,"$1<span>$2<\/span>$3"));var r=new a,i=r.dataFilter;i.addRules(CKEDITOR.plugins.pastefromword.getRules(t,i));t.fire("beforeCleanWord",{filter:i});try{n=r.toHtml(n)}catch(u){alert(t.lang.pastefromword.error)}return n=n.replace(/cke:.*?".*?"/g,""),n=n.replace(/style=""/g,""),n.replace(/<span>/g,"")}})();
//# sourceMappingURL=default.min.js.map
